<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Defcon 18 Quals Forensics 200 Write up - Bryce Boe</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <!-- Open Graph tags -->
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Defcon 18 Quals Forensics 200 Write up"/>
            <meta property="og:url" content="http://bryceboe.com/2010/05/25/defcon-18-quals-forensics-200-write-up/"/>
            <meta property="og:description" content="Edit: A bunch more DEFCON 18 write ups can be found at the vnSecurity site. This weekend I competed in the Defcon 18 Qualifiers with team Shellphish. We unfortunately only placed 15th, nonetheless, it was an exciting and challenging weekend. Below is my write up for the Forensics 200 challenge ..."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://bryceboe.com/theme/css/bootstrap.cerulean.min.css" type="text/css"/>
    <link href="http://bryceboe.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://bryceboe.com/theme/css/pygments/solarizedlight.css" rel="stylesheet">
        <link href="http://bryceboe.com/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="http://bryceboe.com/theme/css/style.css" type="text/css"/>

        <link href="http://bryceboe.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Bryce Boe ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://bryceboe.com/" class="navbar-brand">
Bryce Boe            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://bryceboe.com/pages/about">
                             About
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://bryceboe.com/archives/"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://bryceboe.com/2010/05/25/defcon-18-quals-forensics-200-write-up/"
                       rel="bookmark"
                       title="Permalink to Defcon 18 Quals Forensics 200 Write up">
                        Defcon 18 Quals Forensics 200 Write&nbsp;up
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2010-05-25T14:43:00-07:00"> Tue 25 May 2010</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="http://bryceboe.com/tag/hacking/">hacking</a>
        /
	<a href="http://bryceboe.com/tag/python/">python</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p><ins>
Edit: A bunch more <span class="caps">DEFCON</span> 18 write ups can be found at the <a href="http://www.vnsecurity.net/2010/05/defcon-18-quals-writeups-collection/">vnSecurity
site</a>.</ins></p>
<p>This weekend I competed in the Defcon 18 Qualifiers with team Shellphish. We
unfortunately only placed 15th, nonetheless, it was an exciting and challenging
weekend. Below is my write up for the Forensics 200&nbsp;challenge.</p>
<p><del>
I don&#8217;t recall the phrasing they gave (if you remember it please let me know),
however this was the file they provided:</del>
<ins datetime="2010-05-26T03:34:43+00:00">The caption read, &#8220;find the key&#8221; and
linked to this file:</ins> <a href="http://cs.ucsb.edu/~bboe/public/bin/f200_02b7b50f575759cff7.tar">f200_02b7b50f575759cff7.tar.lzma</a></p>
<p>Running <em>file</em> on f200_02b7b50f575759cff7.tar.lzma simply returned <strong>data</strong>
however fortunately the lzma extension was useful to identify that this
possibly be uncompressed with 7zip (<a href="http://lmgtfy.com/?q=lzma+file&amp;l=1">lmgtfy lzma file</a>). On ubuntu there is a
package called p7zip&nbsp;thus:</p>
<div class="highlight"><pre><span class="gp">bryce@sarek:f200$</span> mv f200_02b7b50f575759cff7.tar.lzma f200_02b7b50f575759cff7.tar.7z
<span class="gp">bryce@sarek:f200$</span> p7zip -d f200_02b7b50f575759cff7.tar.7z

<span class="go">7-Zip (A) 9.04 beta  Copyright (c) 1999-2009 Igor Pavlov  2009-05-30</span>
<span class="go">p7zip Version 9.04 (locale=en_US.UTF-8,Utf16=on,HugeFiles=on,8 CPUs)</span>

<span class="go">Processing archive: f200_02b7b50f575759cff7.tar.7z</span>

<span class="go">Extracting  f200_02b7b50f575759cff7.tar</span>

<span class="go">Everything is Ok</span>

<span class="go">Size:       1730560</span>
<span class="go">Compressed: 487746</span>
<span class="gp">bryce@sarek:f200$</span> tar -xf f200_02b7b50f575759cff7.tar
</pre></div>


<p>This extracts 1121 png image&nbsp;files.</p>
<div class="highlight"><pre><span class="gp">bryce@sarek:f200$</span> ls <span class="p">|</span> head
<span class="go">f200_02b7b50f575759cff7.tar</span>
<span class="go">IMG_0001.png</span>
<span class="go">IMG_0002.png</span>
<span class="go">IMG_0003.png</span>
<span class="go">IMG_0004.png</span>
<span class="go">IMG_0005.png</span>
<span class="go">IMG_0006.png</span>
<span class="go">IMG_0007.png</span>
<span class="go">IMG_0008.png</span>
<span class="go">IMG_0009.png</span>
</pre></div>


<p>Using <em>pnginfo</em> one can verify that each image is similar with respect to its
attributes (width, height, bitdepth, channels, etc.). Using manual image
inspection we see a mostly transparent image with some white and black pixels.
Thus using <a href="http://www.pythonware.com/products/pil/">python&#8217;s imaging library</a> (<span class="caps">PIL</span>) we simply write a quick program
that will combine all the images into&nbsp;one:</p>
<div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>
<span class="kn">import</span> <span class="nn">Image</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">new</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;IMG_0001.png&#39;</span><span class="p">)</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">size</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1122</span><span class="p">):</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;IMG_</span><span class="si">%04d</span><span class="s">.png&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pixel</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">getdata</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="c"># not transparent</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">pixel</span> <span class="o">%</span> <span class="n">w</span><span class="p">,</span> <span class="n">pixel</span> <span class="o">*</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">w</span><span class="p">)</span>
                <span class="n">new</span><span class="o">.</span><span class="n">putpixel</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">new</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s">&#39;f200_result.png&#39;</span><span class="p">)</span>
    <span class="n">new</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>


<p>Running this eventually produces the following image, from which the is.gd url
<a href="http://is.gd/ced7F">http://is.gd/ced7F</a> is the key. Yeah Sexy <span class="caps">CPR</span>.</p>
<p><a href="/images/2010/05/f200_result.png"><img alt="Defcon 18 Forensics 200 Result" src="/images/2010/05/f200_result-43x300.png" title="Defcon 18 Forensics 200 Result" /></a></p>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="http://bryceboe.com/2010/12/09/ucsbs-international-capture-the-flag-competition-2010-challenge-6-fear-the-ear/"><span class="caps">UCSB</span>&#8217;s International Capture The Flag Competition 2010 Challenge 6: Fear The <span class="caps">EAR</span></a></li>
        <li><a href="http://bryceboe.com/2009/12/06/ictf09-–-ucsbs-international-capture-the-flag-competition/">iCTF09: <span class="caps">UCSB</span>&#8217;s International Capture the Flag&nbsp;Competition</a></li>
        <li><a href="http://bryceboe.com/2010/05/13/bye-bye-facebook-a-guide-to-leaving-facebook/">Bye Bye Facebook: A Guide to Leaving&nbsp;Facebook</a></li>
        <li><a href="http://bryceboe.com/2011/06/05/defcon-19-quals-forensics-100-and-forensics-300-solution/">Defcon 19 Quals Forensics 100 and Forensics 300&nbsp;Solution</a></li>
        <li><a href="http://bryceboe.com/2010/08/26/python-multiprocessing-and-keyboardinterrupt/">Python Multiprocessing and&nbsp;KeyboardInterrupt</a></li>
    </ul>
</section>
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'bboe'; // required: replace example with your forum shortname
            var disqus_url = 'http://bryceboe.com/2010/05/25/defcon-18-quals-forensics-200-write-up/';
            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item">
                      <a href="https://github.com/bboe"><i class="fa fa-github fa-lg"></i></a>
                      <a href="https://github.com/bboe">github</a>
                    </li>
                    <li class="list-group-item">
                      <a href="http://stackoverflow.com/users/176978/bboe"><i class="fa fa-stack-overflow fa-lg"></i></a>
                      <a href="http://stackoverflow.com/users/176978/bboe">stack-overflow</a>
                    </li>
                    <li class="list-group-item">
                      <a href="http://www.linkedin.com/in/bbzbryce"><i class="fa fa-linkedin fa-lg"></i></a>
                      <a href="http://www.linkedin.com/in/bbzbryce">linkedin</a>
                    </li>
                    <li class="list-group-item">
                      <a href="https://plus.google.com/+BryceBoe?rel=author"><i class="fa fa-google-plus fa-lg"></i></a>
                      <a href="https://plus.google.com/+BryceBoe?rel=author">google+</a>
                    </li>
                    <li class="list-group-item">
                      <a href="https://twitter.com/bboe"><i class="fa fa-twitter fa-lg"></i></a>
                      <a href="https://twitter.com/bboe">twitter</a>
                    </li>
                  </ul>
                </li>

                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
                    <ul class="list-group" id="recentposts">
                        <li class="list-group-item">
                            <a href="http://bryceboe.com/2014/03/27/daniel-boe-march-27-1988-february-28-2014/">
                                Daniel Boe: March 27, 1988 - February 28,&nbsp;2014
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="http://bryceboe.com/2014/01/25/hello-pelican-world/">
                                Hello Pelican&nbsp;World
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="http://bryceboe.com/2013/05/29/ph-d-proposal-announcement/">
                                Ph.D. Proposal&nbsp;Announcement
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="http://bryceboe.com/2013/05/12/mothers-day/">
                                Mother&#8217;s&nbsp;Day
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="http://bryceboe.com/2012/11/05/time-zones-in-python-and-datetime-representations/">
                                Time Zones in Python and Date/Time&nbsp;Representations
                            </a>
                        </li>
                    </ul>
                </li>


                <li class="list-group-item"><a href="http://bryceboe.com/tags/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group" id="tags">
                    </ul>
                </li>    
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://adamdoupe.com/" target="_blank">
                Adam Doupé
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://juliebifano.com/" target="_blank">
                Julie Bifano
            </a>
        </li>
      </ul>
    </li>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 Bryce Boe
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://code.jquery.com/jquery.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://bryceboe.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://bryceboe.com/theme/js/respond.min.js"></script>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'bboe'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-510348-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();

    </script>
</body>
</html>