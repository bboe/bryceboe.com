<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>Bypassing Gogo’s Inflight Internet Authentication - Bryce Boe</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <!-- Open Graph tags -->
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="Bypassing Gogo’s Inflight Internet Authentication"/>
            <meta property="og:url" content="https://bryceboe.com/2012/03/12/bypassing-gogos-inflight-internet-authentication/"/>
            <meta property="og:description" content="Two weeks ago I attended SIGCSE 2012 in Raleigh, NC. The plane on my return flight had Internet access through Gogo’s Inflight Internet. While I think it’s incredibly awesome that Internet access is readily available to those who travel by plane, I personally feel it is not worth …"/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://bryceboe.com/theme/css/bootstrap.cerulean.min.css" type="text/css"/>
    <link href="https://bryceboe.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://bryceboe.com/theme/css/pygments/solarizedlight.css" rel="stylesheet">
        <link href="https://bryceboe.com/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="https://bryceboe.com/theme/css/style.css" type="text/css"/>

        <link href="https://bryceboe.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Bryce Boe ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://bryceboe.com/" class="navbar-brand">
Bryce Boe            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="https://bryceboe.com/archives/"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://bryceboe.com/2012/03/12/bypassing-gogos-inflight-internet-authentication/"
                       rel="bookmark"
                       title="Permalink to Bypassing Gogo’s Inflight Internet Authentication">
                        Bypassing Gogo&#8217;s Inflight Internet&nbsp;Authentication
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2012-03-12T17:19:00-07:00"> Mon 12 March 2012</time>
    </span>



    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Two weeks ago I attended <a href="http://www.sigcse.org/sigcse2012/"><span class="caps">SIGCSE</span> 2012</a> in Raleigh, <span class="caps">NC</span>. The plane on my return
flight had Internet access through <a href="http://www.gogoair.com/">Gogo&#8217;s Inflight Internet</a>. While I think
it&#8217;s incredibly awesome that Internet access is readily available to those who
travel by plane, I personally feel it is not worth $12.95 for a few hours of
access. Nevertheless, I figured I&#8217;d simply connect to Gogo&#8217;s network to see
what sort of access was permitted to non-authenticated, i.e., non-paying,
users. What I discovered surprised me: I was able to gain access to the entire&nbsp;Internet.</p>
<p>Immediately from links on their landing page it was apparent that Gogo
permitted access to its own website, as well as the airline&#8217;s website and a few
other third-party sites such as <a href="http://livingsocial.com">Living Social</a>, and <a href="http://eventful.com/">Eventful</a>. Attempting
to access any other website resulted in a redirect to Gogo&#8217;s landing page. Gogo
appears to accomplish this by responding with an <span class="caps">HTTP</span> redirect to any standard
<span class="caps">HTTP</span> request, i.e., port 80, that is sent to a non-permitted <span class="caps">IP</span>&nbsp;address.</p>
<p>Two common techniques for bypassing pay-for-wireless providers are
<a href="http://www.cs.uit.no/~daniels/PingTunnel/"><span class="caps">TCP</span>-over-<span class="caps">ICMP</span></a> and <a href="http://analogbit.com/tcp-over-dns_howto"><span class="caps">TCP</span>-over-<span class="caps">DNS</span></a>. In a nutshell, <span class="caps">TCP</span> is the protocol
required to browse the web, <span class="caps">ICMP</span> is the protocol used by the command <code>ping</code> to
determine if a host is available, and <span class="caps">DNS</span> is required to resolve domain names
like <a href="http://www.google.com">www.google.com</a> to an <span class="caps">IP</span> address. When <span class="caps">TCP</span> is not completely available
yet either <span class="caps">ICMP</span> or <span class="caps">DNS</span> is, then it is possible to encapsulate <span class="caps">TCP</span> connections
over the other available protocol. Gogo blocked my ping attempts, hence
<span class="caps">TCP</span>-over-<span class="caps">ICMP</span> was not possible. However, while Gogo doesn&#8217;t permit direct
access to external <span class="caps">DNS</span> servers, Gogo&#8217;s <span class="caps">DNS</span> server recursively resolved the <span class="caps">DNS</span>
queries I made. Therefore, Gogo appears to be susceptible to <span class="caps">TCP</span>-over-<span class="caps">DNS</span>.
Despite not being able to verify this finding, I will simply state that Gogo
can remedy this, if necessary, by only responding to white-listed <span class="caps">DNS</span> queries
for non-authenticated&nbsp;users.</p>
<p>As a quick aside, I would like to mention I made an attempt to responsibly
disclose this information to Gogo prior to posting this article [<a href="/images/2012/03/gogo_dm.png">1</a>, <a href="https://twitter.com/#!/Gogo/status/176504298967015424">2</a>].
I contacted one of their twitter representatives via email who informed me the
right person would contact me. After a few days with no response, I sent a
follow up email to the same twitter representative. While that representative
has continued to tweet since my followup, I have received no replies. Thus, I
have come to the conclusion that Gogo is uninterested. I proceed with the
knowledge that this authentication bypass in no way compromises Gogo&#8217;s
security; therefore, it is of negligible importance to Gogo&#8217;s existing
customers. Finally, I proceed knowing very well that Gogo&#8217;s sysadmins can
correct the underlying problem in a very brief period of time and I even
present them with the&nbsp;solution.</p>
<p>♫<a href="http://www.youtube.com/watch?v=GI6CfKcMhjY&amp;t=1m37s">Now back to the good part</a>!♫</p>
<p>I use <a href="https://www.google.com/chrome">Google Chrome</a> as my primary browser and along with it I have
installed a few extensions that depend on connections to various Google
services. When Chrome is open and does not have a connection to the Internet,
some of these extensions, such as the <a href="https://chrome.google.com/webstore/detail/apflmjolhbonpkbkooiamcnenbmbjcbf">Google Reader Notifier</a>, adjust their
icon to indicate their disconnected status. As expected, the Google Reader
Notifier extension indicated that I was not connected to the Internet. However,
as I was browsing around Gogo&#8217;s landing page and permitted sites, I was shocked
when the <a href="https://chrome.google.com/webstore/detail/kcnhkahnjcbndmmehfkdnkjomaanaooo">Google Voice</a> extension notified me of a new text message and
shocked again when I successfully replied. I had mistakenly stumbled across a
hole in Gogo&#8217;s access policies and decided to dig&nbsp;deeper.</p>
<p>As I previously mentioned, Gogo redirected to their landing page upon any
standard <span class="caps">HTTP</span> request. However, the same was not true for <span class="caps">HTTPS</span> connections,
which by default occur on <span class="caps">TCP</span> port 443. Thus, for some unknown reason, my
computer was able to connect to <a href="http://www.google.com">www.google.com</a> via <span class="caps">HTTPS</span>. Immediately I
tried other Google services, like <a href="http://mail.google.com">mail.google.com</a> for Gmail, and
<a href="http://docs.google.com">docs.google.com</a> for Google docs; neither worked. Nevertheless, any Google
service accessible via <span class="caps">HTTPS</span> and addressed under the <a href="http://www.google.com">www.google.com</a> domain
worked&nbsp;flawlessly.</p>
<p>After poking around to find a list of Google services meeting these
requirements, I had an epiphany. While I probably learned this information at
some point in my past, I had a hunch that Google&#8217;s front-end web servers would
likely provide the correct response to any Google web service. Hence, I opened
up my /etc/hosts file on my <span class="caps">OS</span> X machine, and added the following&nbsp;line:</p>
<div class="highlight"><pre><span></span><code>74.125.225.40 mail.google.com
</code></pre></div>

<p>Voila! Immediately, I was able to access Gmail. The <span class="caps">IP</span> address, 74.125.225.40,
corresponds to the <span class="caps">IP</span> address my computer was successfully able to connect to
in order to access services under the <a href="http://www.google.com">www.google.com</a> domain. By adding this
manual entry to my hosts file, I informed my operating system to use the
provided <span class="caps">IP</span> address when attempting to connect to mail.google.com. In order to
additionally receive successful access to <a href="http://plus.google.com">Google+</a>, <a href="http://youtube.com">YouTube</a>, <a href="http://docs.google.com">Google
Docs</a>, <a href="http://code.google.com">Google Code</a>, and Google&#8217;s chat interface, I updated
the line to the&nbsp;following:</p>
<div class="highlight"><pre><span></span><code>74.125.225.40 mail.google.com plus.google.com youtube.com docs.google.com code.google.com chatenabled.mail.google.com
</code></pre></div>

<p>What I previously described is how I was able to bypass Gogo&#8217;s Inflight
Internet Authentication in order to access a number of Google services for
free. What remains is how to utilize this information to access the entire
Internet. The answer to this question lies with <a href="http://code.google.com/appengine/">Google AppEngine</a>.</p>
<p>Google AppEngine (<span class="caps">GAE</span>) is a cloud-based web application hosting service
provided by Google. Anyone can run a <span class="caps">GAE</span> application on Google&#8217;s servers. As I
previously described, Google&#8217;s front-end web servers respond to requests for
any Google web service, including third-party <span class="caps">GAE</span> applications. The final piece
of the puzzle is that <span class="caps">GAE</span> allows its applications to themselves make web
requests. Therefore, a well written <span class="caps">GAE</span> application can operate as a proxy
server. In fact, there are a number of available packages for running simple
<span class="caps">GAE</span> proxy servers. <a href="http://www.labnol.org/internet/setup-proxy-server/12890/">Digital Inspiration</a> and <a href="http://mintywhite.com/software-reviews/security-software/set-proxy-google-app-engine/">Windows Guides</a> each provide
tutorials for setting up such proxies. The Windows Guides tutorial even links
to a working example at <a href="https://jttm-server-prox.appspot.com/">https://jttm-server-prox.appspot.com/</a>. A user of
Gogo&#8217;s Inflight Internet need only add jttm-server-prox.appspot.com to their
hosts file in order to utilize this proxy to access much of the&nbsp;Internet.</p>
<p>I have previously described how Gogo&#8217;s Inflight Internet authentication can be
bypassed through the combination of a custom hosts file and a <span class="caps">GAE</span> proxy server.
The remainder of this article will detail how Gogo can fix this&nbsp;problem.</p>
<p>The root question, is: why does Gogo allow non-authenticated access to some
Google IPs? While my answer to this question is purely speculation, the
solution I offer will absolutely solve the problem. I speculate that Gogo
allows access to some Google IPs because of <a href="http://www.google.com/analytics/">Google Analytics</a> and <a href="https://www.google.com/adsense/">Google
Adsense</a>, indicated in client scripts by the domains www.google-analytics.com
and ad.doubleclick.net respectively. If correct, Gogo&#8217;s sysadmins simply
white-listed a few too many <span class="caps">IP</span> addresses. Regardless, the point is moot because
any Google front-end web server <span class="caps">IP</span> address, including those for Analytics and
Adsense, will serve the reply for all Google web services, most notably <span class="caps">GAE</span>
applications. Hence, by white-listing any single Google front-end web server <span class="caps">IP</span>
address, Gogo is essentially providing access to the entire Internet. It
follows, that the simplest solution to this bypass is for Gogo to completely
disable direct access to Google IPs from non-authenticated&nbsp;users.</p>
<p>While the above solution absolutely works, it prevents Gogo from tracking users
and serving ads using Google services. Of course, serving ads is pointless when
non-authenticated users cannot visit the target site of the advertisement, so
let&#8217;s forget about Google Adsense. Google Analytics on the other hand, is a
useful tool for monitoring users&#8217; access to a website. Let&#8217;s now proceed under
the assumption that it is essential for Gogo&#8217;s non-authenticated users to have
access to whatever Google service Gogo intended to allow, and for simplicity
assume it is the Google Analytics tracking service. The question now is: how
can Gogo allow access to the Google Analytics tracking service without allowing
access to all other Google services? This answer partially lies with <a href="http://en.wikipedia.org/wiki/Server_Name_Indication">Server
Name Indication</a>.</p>
<p>Server Name Indication (<span class="caps">SNI</span>) is implemented on most modern web browsers and
allows a web server with a single <span class="caps">IP</span> address to serve multiple <span class="caps">TLS</span>
certificates. The proper certificate is returned in response to the hostname
provided in the <span class="caps">TLS</span> client handshake. The use of <span class="caps">SNI</span> is why, despite using the
same <span class="caps">IP</span> address for all the aforementioned services, Google is able to return
the appropriate domain-specific <span class="caps">TLS</span> certificate. Therefore, Gogo can
additionally white-list on the <span class="caps">SNI</span>-hostname in order to prevent the
authentication bypass and still allow access to Google Analytics. However,
things are not so simple, as Google&#8217;s servers do not depend on the presence of
the <span class="caps">SNI</span>-hostname in the <span class="caps">TLS</span> client&nbsp;handshake.</p>
<p>In the absence of <span class="caps">SNI</span>, Google&#8217;s front-end web servers return the default <span class="caps">TLS</span>
certificate for that particular server, yet, the server still responds with the
requested content as indicated in the <span class="caps">HTTP</span> host header. Because the <span class="caps">HTTP</span> host
header is encrypted, as well as the entire response, it is not possible to
discern desired requests from undesired requests. One solution is to only allow
such access to Google Analytics if the client supports <span class="caps">SNI</span> and the <span class="caps">SNI</span>-hostname
is in the white-list. While this approach would work, it appears it would
restrict access to Google Analytics for some browsers that are <a href="http://en.wikipedia.org/wiki/Server_Name_Indication#No_support">still commonly
used</a>.</p>
<p>Regardless, I suspect that Google&#8217;s front-end web servers do not verify
consistency between the <span class="caps">SNI</span>-hostname and the <span class="caps">HTTP</span> host header. Under that
assumption, it would still be possible, in the presence of an <span class="caps">SNI</span>-hostname
white-list, to bypass Gogo&#8217;s authentication with a custom browser (or local
proxy server) that negotiates <span class="caps">TLS</span> handshakes using only the expected
<span class="caps">SNI</span>-hostname yet still makes the desired Google web service request. While I
don&#8217;t believe anything is readily accessible to make this process easy for
99.9% of Gogo&#8217;s potential customers, it only requires a single person&#8217;s
determination to make it so. Thus, the only be-all-end-all solution to prevent
this bypass is for Gogo to completely disable direct access to Google IPs from
non-authenticated&nbsp;users.</p>
<p>There is, of course, one other possible solution: Gogo could
<a href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack">man-in-the-middle</a> the desired Google web services in order to perform
filtering on the <span class="caps">HTTP</span> host header. However, this approach could have unforeseen
consequences. Therefore, I do not recommend&nbsp;it.</p>
<p>In conclusion, I have described how one can currently bypass Gogo&#8217;s Inflight
Internet authentication to access much of the Internet using a custom host file
and a Google AppEngine proxy. I have also described how Gogo can somewhat block
this bypass by supplementing their <span class="caps">IP</span> white-list with both an <span class="caps">SNI</span> requirement
and an <span class="caps">SNI</span>-hostname white-list. Finally, I speculated that even with the
aforementioned solution, it would still be possible for a determined user to
bypass their authentication. Thus, I stated the only real solution is for Gogo
to not allow any direct access between non-authenticated users and Google web&nbsp;servers.</p>
<p>Happy &#8220;free&#8221; surfing, for now anyway&nbsp;:)</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'bboe'; // required: replace example with your forum shortname
            var disqus_url = 'https://bryceboe.com/2012/03/12/bypassing-gogos-inflight-internet-authentication/';
            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item">
                      <a href="https://github.com/bboe"><i class="fa fa-github fa-lg"></i></a>
                      <a href="https://github.com/bboe">github</a>
                    </li>
                    <li class="list-group-item">
                      <a href="http://stackoverflow.com/users/176978/bboe"><i class="fa fa-stack-overflow fa-lg"></i></a>
                      <a href="http://stackoverflow.com/users/176978/bboe">stack-overflow</a>
                    </li>
                    <li class="list-group-item">
                      <a href="http://www.linkedin.com/in/bbzbryce"><i class="fa fa-linkedin fa-lg"></i></a>
                      <a href="http://www.linkedin.com/in/bbzbryce">linkedin</a>
                    </li>
                    <li class="list-group-item">
                      <a href="https://twitter.com/bboe"><i class="fa fa-twitter fa-lg"></i></a>
                      <a href="https://twitter.com/bboe">twitter</a>
                    </li>
                  </ul>
                </li>

                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
                    <ul class="list-group" id="recentposts">
                        <li class="list-group-item">
                            <a href="https://bryceboe.com/2014/03/27/daniel-boe-march-27-1988-february-28-2014/">
                                Daniel Boe: March 27, 1988 - February 28,&nbsp;2014
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="https://bryceboe.com/2014/01/25/hello-pelican-world/">
                                Hello Pelican&nbsp;World
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="https://bryceboe.com/2013/05/29/ph-d-proposal-announcement/">
                                Ph.D. Proposal&nbsp;Announcement
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="https://bryceboe.com/2013/05/12/mothers-day/">
                                Mother&#8217;s&nbsp;Day
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="https://bryceboe.com/2012/11/05/time-zones-in-python-and-datetime-representations/">
                                Time Zones in Python and Date/Time&nbsp;Representations
                            </a>
                        </li>
                    </ul>
                </li>


                <li class="list-group-item"><a href="https://bryceboe.com/tags/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group" id="tags">
                    </ul>
                </li>    
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://adamdoupe.com/" target="_blank">
                Adam Doupé
            </a>
        </li>
      </ul>
    </li>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 Bryce Boe
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="//code.jquery.com/jquery.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://bryceboe.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://bryceboe.com/theme/js/respond.min.js"></script>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'bboe'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-510348-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();

    </script>
</body>
</html>