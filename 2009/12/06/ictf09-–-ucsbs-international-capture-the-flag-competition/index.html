<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>iCTF09: UCSB’s International Capture the Flag Competition - Bryce Boe</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    

    <!-- Open Graph tags -->
            <meta property="og:type" content="article"/>
            <meta property="og:title" content="iCTF09: UCSB’s International Capture the Flag Competition"/>
            <meta property="og:url" content="https://bryceboe.com/2009/12/06/ictf09-–-ucsbs-international-capture-the-flag-competition/"/>
            <meta property="og:description" content="As a member of the Security Lab at UCSB I had the privilege to help create and run this year’s iCTF Hacking Competition. The six-year-old competition was very unique this year. Unlike CTFs seen before in which teams try to protect their services whilst attacking other teams’ services, our …"/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://bryceboe.com/theme/css/bootstrap.cerulean.min.css" type="text/css"/>
    <link href="https://bryceboe.com/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://bryceboe.com/theme/css/pygments/solarizedlight.css" rel="stylesheet">
        <link href="https://bryceboe.com/theme/css/typogrify.css" rel="stylesheet">
    <link rel="stylesheet" href="https://bryceboe.com/theme/css/style.css" type="text/css"/>

        <link href="https://bryceboe.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Bryce Boe ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://bryceboe.com/" class="navbar-brand">
Bryce Boe            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="https://bryceboe.com/archives/"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<div class="container">
    <div class="row">
        <div class="col-sm-9">

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://bryceboe.com/2009/12/06/ictf09-–-ucsbs-international-capture-the-flag-competition/"
                       rel="bookmark"
                       title="Permalink to iCTF09: UCSB’s International Capture the Flag Competition">
                        iCTF09: <span class="caps">UCSB</span>&#8217;s International Capture the Flag&nbsp;Competition
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2009-12-06T00:45:00-08:00"> Sun 06 December 2009</time>
    </span>



<span class="label label-default">Tags</span>
	<a href="https://bryceboe.com/tag/hacking/">hacking</a>
        /
	<a href="https://bryceboe.com/tag/python/">python</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>As a member of the Security Lab at <span class="caps">UCSB</span> I had the privilege to help create and
run this year&#8217;s <a href="http://ictf.cs.ucsb.edu/">iCTF</a> Hacking Competition. The six-year-old competition was
very unique this year. Unlike CTFs seen before in which teams try to protect
their services whilst attacking other teams&#8217; services, our competition had
teams deliver <a href="http://en.wikipedia.org/wiki/Drive-by_download">drive-by downloads</a> to users for the purpose of stealing money
from the users&#8217; bank&nbsp;accounts.</p>
<p>In order to deliver drive-by downloads, the teams had to bring users to their
webpage by boosting their search result on the search server for desired search
terms. The users&#8217; browsing pattern was they would search for a random word from
a news site and then visit one of the resulting pages chosen according a
<a href="http://en.wikipedia.org/wiki/Pareto_distribution">Pareto distribution</a>, meaning the top search result would have the highest
probability of being picked with the last result the&nbsp;lowest.</p>
<p>The challenge there was to figure out how to boost the search results for
particular keywords, unfortunately most of the teams simply duplicated the news
site; this definitely was the safest strategy though slightly disappointing to
me as I wrote the search engine code. I can claim that neither the search
engine, nor the index server broke during the competition. The crawler had a
few issues with some team&#8217;s pages, which I quickly fixed. I have made the
<a href="http://cs.ucsb.edu/~bboe/public/ictf09/search_engine.tar.gz">search engine code</a> available that was used in&nbsp;iCTF09.</p>
<p>In addition to writing the search engine, I wrote three challenges for the
competition. The first challenge I wrote was called &#8220;The Difference&#8221;, or
Forensics 4. The only information people were given was the title and the
following image. The first step to solve this challenge is recognizing the
image is the <a href="http://xkcd.com/">xkcd</a> comic &#8220;<a href="http://xkcd.com/242/">The Difference</a>&#8220;.</p>
<p><a href="/images/2009/12/the_difference.png"><img alt="The Difference" src="/images/2009/12/the_difference-159x300.png" title="The Difference"></a></p>
<p>After downloading the original image one should notice
the two files are different sizes with the original being <span class="caps">32KB</span> and my image
46K. At this point a pixel-by-pixel comparison is required which reveals that
60 of the pixels differ and the values of the differing pixels are always
larger in my image. This is where &#8220;The Difference&#8221; first comes into play by
subtracting the value in my image from that of the&nbsp;original.</p>
<p>Doing so produces the results shown in <a href="http://cs.ucsb.edu/~bboe/public/ictf09/the_difference_values.txt">the_difference_values.txt</a>. Each
line contains the difference value and the index of the pixel. The values in
this list range from 33 to 41 with exceptions 10, 12 and 15. Additionally the
numbers appear in groups of three where last number in the group is sometimes
larger. After a bit of pondering the realization sets in that <a href="http://en.wikipedia.org/wiki/ASCII"><span class="caps">ASCII</span></a>
lowercase values range from 97 to 122 with space being 32 and hyphen 45. It
should hit you like a ton of bricks that you need to sum the groups of three
together and then convert the number to its <span class="caps">ASCII</span>&nbsp;value.</p>
<p>The string &#8220;sixty-four seventeen&#8221; now appears and you think you&#8217;ve solved the
challenge, but no, it&#8217;s not quite done. This is where &#8220;The Difference&#8221; comes
back into play in that you have to subtract these two numbers to get
forty-seven. There were 596 submissions for this challenge of which 2 were
correct. I&#8217;ve made the source to both <a href="http://cs.ucsb.edu/~bboe/public/ictf09/the_difference_maker.py">generate</a> and <a href="http://cs.ucsb.edu/~bboe/public/ictf09/the_difference_checker.py">verify</a> this
challenge&nbsp;available.</p>
<p>The second challenge I wrote had 75 submissions and 0 correct solutions. This
challenge was one of the Trivia 3 problems that had a <a href="http://cs.ucsb.edu/~bboe/public/ictf09/theparagraphs.txt">text file</a> and the
following blurb associated with&nbsp;it:</p>
<blockquote>
<p>Rummaging through the attic one afternoon Sally found a notebook which on the
cover read &#8216;What happened in 95?&#8217;. On one of the pages she found the
following two paragraphs of text which appeared as gibberish to her. She
copied the two paragraphs down as best she could, however there were
forty-five characters which she couldn&#8217;t make out from the first paragraph,
which she simply neglected. What are those 45&nbsp;characters?</p>
</blockquote>
<p>The concept behind this problem is a <a href="http://en.wikipedia.org/wiki/One-time_pad">one-time pad</a>, where a completely
random sequence of characters the same length as the original text is generated
and then <a href="http://en.wikipedia.org/wiki/Exclusive_or"><span class="caps">XOR</span></a>ed with the original text to create the cipher text. At this
point the original text can be discarded and recovered by XORing the cipher
text with the one-time&nbsp;pad.</p>
<p>The challenge to this problem is finding where the 45 missing characters go,
and what they are. One additional difficulty is figuring out that the <span class="caps">ASCII</span>
values need to be subtracted by 95 prior to XORing so the numbers being XORed
fit within 32 bits. This can be discovered by taking the min value that appears
in the paragraphs which is 95 corresponding to &#8216;_&#8217; and additionally the max
value that appears which is 126 corresponding to &#8216;~&#8217;. The &#8216;95&#8217; that appears in
the blurb was to hint at&nbsp;this.</p>
<p>Finding the places where the characters should go requires XORing the current
one-time pad with the cipher text. Plain text English with no punctuation or
spaces will result at the beginning of the output until nonsense text is
output. This is the point in which a character needs to be added to the
one-time pad. This process needs to be repeated for all 45&nbsp;characters.</p>
<p>At this point, XORing the one-time pad character with the desired character
will result in the missing character. The solution is the concatenation of all
the missing characters. This is &#8220;sdnalsilennahcehtdnuoradnuofebnacsehcnarbidun&#8221;
which is &#8220;nudibranchescanbefoundaroundthechannelislands&#8221;&nbsp;reversed.</p>
<p>I&#8217;ve made the <a href="http://cs.ucsb.edu/~bboe/public/ictf09/otp_creator.py">code to generate</a> this challenge available. You&#8217;ll notice it
loops until the one-time pad contains the characters of the solution. The
<a href="http://cs.ucsb.edu/~bboe/public/ictf09/otp_text.txt">original text</a> is a passage from <a href="http://en.wikipedia.org/wiki/James_Joyce">Joyce&#8217;s</a> <a href="http://en.wikipedia.org/wiki/Dubliners">Dubliners</a> that contains the
oldest reference I know of to the phrase, &#8220;<a href="http://www.urbandictionary.com/define.php?term=how+goes+it">how goes it</a>&#8220;. I did not write a
solution for this&nbsp;problem.</p>
<p>The third and final problem I wrote was called 0xDEAFBABE or Trivia 2. A
<a href="http://cs.ucsb.edu/~bboe/public/ictf09/0xDEAFBABE.mid">binary file</a> (renamed to include .mid to resolve content type issues) was
provided which the program file correctly informs that it is a midi audio file.
By playing the file one hears about one note a second. Many teams tried to
figure out what the notes were as they would be on a musical scale, such as c
sharp or b flat, however that was a bit over thinking it. The solution was
simply to print the <span class="caps">ASCII</span> character that corresponds to each <a href="http://www.midi.org/techspecs/midimessages.php">midi note
number</a>. These numbers range from 0 to 127, thus they&#8217;re perfect for text.
The solution to this was &#8220;does this not sound super cool?&#8221; There were 207
submissions of which 21 were correct. I have made my source to <a href="http://cs.ucsb.edu/~bboe/public/ictf09/midi_generation.py">generate</a>
and <a href="http://cs.ucsb.edu/~bboe/public/ictf09/midi_checker.py">verify</a> this challenge&nbsp;available.</p>
<p>If you competed in the iCTF and attempted or completed any of these challenges
let me know what you thought and how long you spent on them. I recall someone
in the chat yesterday saying they were losing their sanity trying to solve &#8220;The
Difference&#8221;; that gave me a good laugh&nbsp;:)</p>
            </div>
            <!-- /.entry-content -->
<section class="well" id="related-posts">
    <h4>Related Posts:</h4>
    <ul>
        <li><a href="https://bryceboe.com/2011/06/05/defcon-19-quals-forensics-100-and-forensics-300-solution/">Defcon 19 Quals Forensics 100 and Forensics 300&nbsp;Solution</a></li>
        <li><a href="https://bryceboe.com/2010/12/09/ucsbs-international-capture-the-flag-competition-2010-challenge-6-fear-the-ear/"><span class="caps">UCSB</span>&#8217;s International Capture The Flag Competition 2010 Challenge 6: Fear The <span class="caps">EAR</span></a></li>
        <li><a href="https://bryceboe.com/2010/05/25/defcon-18-quals-forensics-200-write-up/">Defcon 18 Quals Forensics 200 Write&nbsp;up</a></li>
        <li><a href="https://bryceboe.com/2010/05/13/bye-bye-facebook-a-guide-to-leaving-facebook/">Bye Bye Facebook: A Guide to Leaving&nbsp;Facebook</a></li>
        <li><a href="https://bryceboe.com/2014/01/25/hello-pelican-world/">Hello Pelican&nbsp;World</a></li>
    </ul>
</section>
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'bboe'; // required: replace example with your forum shortname
            var disqus_url = 'https://bryceboe.com/2009/12/06/ictf09-–-ucsbs-international-capture-the-flag-competition/';
            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3 well well-sm" id="sidebar">

<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
                  <ul class="list-group" id="social">
                    <li class="list-group-item">
                      <a href="https://github.com/bboe"><i class="fa fa-github fa-lg"></i></a>
                      <a href="https://github.com/bboe">github</a>
                    </li>
                    <li class="list-group-item">
                      <a href="http://stackoverflow.com/users/176978/bboe"><i class="fa fa-stack-overflow fa-lg"></i></a>
                      <a href="http://stackoverflow.com/users/176978/bboe">stack-overflow</a>
                    </li>
                    <li class="list-group-item">
                      <a href="http://www.linkedin.com/in/bbzbryce"><i class="fa fa-linkedin fa-lg"></i></a>
                      <a href="http://www.linkedin.com/in/bbzbryce">linkedin</a>
                    </li>
                    <li class="list-group-item">
                      <a href="https://plus.google.com/+BryceBoe?rel=author"><i class="fa fa-google-plus fa-lg"></i></a>
                      <a href="https://plus.google.com/+BryceBoe?rel=author">google+</a>
                    </li>
                    <li class="list-group-item">
                      <a href="https://twitter.com/bboe"><i class="fa fa-twitter fa-lg"></i></a>
                      <a href="https://twitter.com/bboe">twitter</a>
                    </li>
                  </ul>
                </li>

                <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
                    <ul class="list-group" id="recentposts">
                        <li class="list-group-item">
                            <a href="https://bryceboe.com/2014/03/27/daniel-boe-march-27-1988-february-28-2014/">
                                Daniel Boe: March 27, 1988 - February 28,&nbsp;2014
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="https://bryceboe.com/2014/01/25/hello-pelican-world/">
                                Hello Pelican&nbsp;World
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="https://bryceboe.com/2013/05/29/ph-d-proposal-announcement/">
                                Ph.D. Proposal&nbsp;Announcement
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="https://bryceboe.com/2013/05/12/mothers-day/">
                                Mother&#8217;s&nbsp;Day
                            </a>
                        </li>
                        <li class="list-group-item">
                            <a href="https://bryceboe.com/2012/11/05/time-zones-in-python-and-datetime-representations/">
                                Time Zones in Python and Date/Time&nbsp;Representations
                            </a>
                        </li>
                    </ul>
                </li>


                <li class="list-group-item"><a href="https://bryceboe.com/tags/"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                    <ul class="list-group" id="tags">
                    </ul>
                </li>    
    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://adamdoupe.com/" target="_blank">
                Adam Doupé
            </a>
        </li>
        <li class="list-group-item">
            <a href="http://juliebifano.com/" target="_blank">
                Julie Bifano
            </a>
        </li>
      </ul>
    </li>

        </ul>
    </section>

</aside>        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2014 Bryce Boe
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="//code.jquery.com/jquery.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://bryceboe.com/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://bryceboe.com/theme/js/respond.min.js"></script>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'bboe'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-510348-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();

    </script>
</body>
</html>